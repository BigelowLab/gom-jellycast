---
title: "gom-jellycast"
---

```{r setup, echo = FALSE, include = FALSE}
source("setup.R")
buffer <- read_coastline_buffer()
buffer_bbox <- st_bbox(buffer)

obs <- read_obs() %>%
  st_as_sf(coords = c("lon", "lat"), crs = 4326) %>% 
  mutate(
    year = year(date),
    month = factor(month(date, label = TRUE, abbr = TRUE), levels = month.abb),
    type = as.factor(type),
    size_fixed = ifelse(is.na(size), 1, size)
  ) %>% 
  filter(source == "record", 
         type %in% c("lionsmane", "moon")) %>% 
  st_filter(st_as_sfc(buffer_bbox))
```

<section>
  <p>
In the early 2010s, jellyfish began popping up all throughout the Gulf of Maine with seemingly no explanation. Scientists Nick Record and Ben Tupper of the Tandy Center for Ocean Forecasting in the Bigelow Laboratory for Ocean Sciences began asking community members to reach out with their jellyfish sightings in an effort to explain the sudden population increase. 
  </p>
  <p>
This site features an array of jellyfish sighting predictions across the Gulf of Maine to increase public awareness and understanding on the importance and implications of jellyfish in our ecosystems. Tracking jellyfish is important and interesting for beachgoers and boaters alike. On a larger scale, changes in jellyfish populations allow scientists to examine the impacts of climate change. 
  </p>
  <p>
For the [Gulf of Maine Jellyfish Encounter Likelihood Forecast](https://github.com/BigelowLab/gom-jellycast) project, observations come from community scientist reports. The following species have been selected for analysis:

  + *Cyanea capillata* (Lion's Mane)
  + *Aurelia aurita* (Moon)
  </p>
</section>

# Observations Summary
```{r fig.height=15,fig.width=30, echo = FALSE, warning = FALSE}
p1 <- ggplot() +
  geom_sf(data = read_coastline(), color = "black") +
  geom_sf(data = obs, color = "steelblue", size = 1.5) +
  coord_sf(
    xlim = c(buffer_bbox["xmin"], buffer_bbox["xmax"]),
    ylim = c(buffer_bbox["ymin"], buffer_bbox["ymax"]),
    expand = FALSE
  ) +
  labs(
    title = "Distribution of All Observations",
    x = "Longitude",
    y = "Latitude"
  ) +
  theme_minimal(base_size = 24)

p2 <- ggplot() +
  geom_sf(data = read_coastline(), color = "black") +
  geom_sf(
    data = obs,
    aes(size = size_fixed),
    color = "steelblue",
    alpha = 0.4  
  ) +
  scale_size_area(max_size = 8) +  
  coord_sf(
    xlim = c(buffer_bbox["xmin"], buffer_bbox["xmax"]),
    ylim = c(buffer_bbox["ymin"], buffer_bbox["ymax"]),
    expand = FALSE
  ) +
  labs(
    title = "Distribution of All Observations by Size",
    x = "Longitude",
    y = "Latitude",
    size = "Diameter (cm)"
  ) +
  theme_minimal(base_size = 24) +
  guides(size = guide_legend(override.aes = list(alpha = 1)))

p1 + p2

```

```{r fig.height=10,fig.width=20, echo = FALSE, warning = FALSE}
p3 <- ggplot(data = obs, aes(x = factor(year))) +
  geom_bar(fill = "steelblue") +
  labs(
    title = "Number of Observations per Year",
    x = "Year",
    y = "Count"
  ) +
  theme_minimal(base_size = 24)

p4 <- ggplot(obs, aes(x = factor(month))) +
  geom_bar(fill = "steelblue") +
  labs(
    title = "Number of Observations per Month",
    x = "Month",
    y = "Count"
  ) +
  theme_minimal(base_size = 24)

p3 + p4
```

# Species Distributions by Size
```{r fig.height=15,fig.width=30, echo = FALSE, warning = FALSE}
lm <- obs %>% 
  filter(type == "lionsmane")

p5 <- ggplot() +
  geom_sf(data = read_coastline(), color = "black") +
  geom_sf(data = lm, aes(size = size_fixed), color = "steelblue", alpha = 0.4) +
  scale_size_area(max_size = 8) +  
  coord_sf(
    xlim = c(buffer_bbox["xmin"], buffer_bbox["xmax"]),
    ylim = c(buffer_bbox["ymin"], buffer_bbox["ymax"]),
    expand = FALSE
  ) +
  labs(
    title = "Lion's Mane Jellyfish",
    x = "Longitude",
    y = "Latitude",
    size = "Diameter (cm)"
  ) +
  theme_minimal(base_size = 24) +
  guides(size = guide_legend(override.aes = list(alpha = 1)))

moon <- obs %>% 
  filter(type == "moon")

p6 <- ggplot() +
  geom_sf(data = read_coastline(), color = "black") +
  geom_sf(data = moon, aes(size = size_fixed), color = "steelblue", alpha = 0.4) +
  scale_size_area(max_size = 8) +  
  coord_sf(
    xlim = c(buffer_bbox["xmin"], buffer_bbox["xmax"]),
    ylim = c(buffer_bbox["ymin"], buffer_bbox["ymax"]),
    expand = FALSE
  ) +
  labs(title = "Moon Jellyfish",
    x = "Longitude",
    y = "Latitude",
    size = "Diameter (cm)"
  ) +
  theme_minimal(base_size = 24) +
  guides(size = guide_legend(override.aes = list(alpha = 1)))

p5 + p6
```


